graphics node Triangle(rtv renderTarget : SV_Target0);
graphics node Blur(rtv backBuffer : SV_Target0, float sigma, srv srcTexture);
graphics node Bloom(rtv backbuffer : SV_Target0, srv srcTexture, float bloomThreshold, float bloomStrength, float scatter, float clampMax);

export void main([readonly(present)] texture backbuffer, float sigma)
{
    ResourceDesc backbufferDesc = backbuffer.desc();
    uint32_t width = (uint32_t)backbufferDesc.Width;
    uint32_t height = (uint32_t)backbufferDesc.Height;
    RPS_FORMAT backbufferFormat = backbufferDesc.Format;

    texture offscreenRT = create_tex2d(backbufferFormat, width, height);

    clear(offscreenRT, float4(0.0, 0.2, 0.4, 1.0));
    Triangle(offscreenRT);

    Bloom(backbuffer, offscreenRT, 0.42f, 0.14f, 0.6305f, 25000);

	Blur(backbuffer, sigma, offscreenRT); 
}
